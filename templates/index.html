<!DOCTYPE html>
{% load static %}

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        #float-right {
            float: right;
            margin-right: 20%;
            z-index: 9999;
            margin-top: -25%;
        }

        #floatleft {
            float: left;
            z-index: 9999;
            margin-top: -25%;
            margin-left: 10%;
            display: inline;
        }

        #imgheight {
            height: 550px;
        }

        #btnloc {
            margin-top: -62px;
            margin-left: 150px;

        }

        @media only screen and (max-width: 500px) {
            #floatleft {
                margin-top: auto;
                margin-left: 10px;

            }

            #float-right {
                width: 70%;
                z-index: 9999;
                margin-top: -185px;
            }

            #imgheight {
                height: 200px;
            }

            #btnloc {
                margin-top: -65px;
                margin-left: 130px;

            }
        }

        @media only screen and (min-width: 500px) and (max-width: 1200px) {
            #floatleft {
                float: left;
                z-index: 9999;
                margin: auto;

            }

            #float-right {
                width: 70%;
                display: inline-block;
                z-index: 9999;
                margin-top: -275px;
            }

            #imgheight {
                height: 450px;
            }

            #btnloc {
                margin-top: -65px;
                margin-left: 135px;

            }
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <a class="navbar-brand" href="#">Navbar</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Link</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Dropdown
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="#">Action</a>
                        <a class="dropdown-item" href="#">Another action</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Something else here</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link disabled" href="#">Disabled</a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>
    </nav>

    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img id="imgheight" src='{% static "gwalior.jpg" %}' class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img id="imgheight" src='{% static "gwalior2.png" %}' class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img id="imgheight" src='{% static "gwalior3.jpg" %}' class="d-block w-100" alt="...">
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
    <div class="col-lg-3 col-md-2" id="float-right">
        <form name="myForm" method="post" id="weatherform">{% csrf_token %}
            <div class="form-group">
                <div class="form-group">
                    <label for="exampleFormControlSelect1">city select</label>
                    <select class="form-control" id="cityname" onchange="myFunction()" name="city">
                        <option>Gwalior</option>
                        <option>Indore</option>
                        <option>Bhopal</option>
                        <option>Jabalpur</option>
                        <option>Mumbai</option>
                    </select>
                </div>
            </div>
            <button type="submit" class="btn btn-primary">checkweather</button>
        </form>
        <form action="knowmore" method="get" id="knowform">{% csrf_token %}
            <input type="hidden"  id="city_name" value="Gwalior" name="city_name" >
            <button type="submit" id="btnloc" class="btn btn-primary">Knowmore</button>
        </form>

    </div>

    <div class="col-lg-3 col-md-4 " id="floatleft">
        <!-- Card -->
        <h3>Get Your Weather Info!</h3>
        <div class="container">
            <!-- Card content -->
            <div class="card-body pb-1">
                <h5 id="city"></h5>
                <p class="card-text" id="date"></p>
                <p id="temp"></p>
                <p id="desc"></p>
            </div>
        </div>
        <!-- Card -->
    </div>


</body>
<script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>
<script>
    $('#weatherform').submit(function (event) {
        var formData = {
            'city': $('#cityname').val(),
            'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val()
        };
        $.ajax({
            type: 'POST',
            url: '/',
            data: formData,
            encode: true
        })

            .done(function (data) {
                console.log(formData)
                data = JSON.parse(data);
                updates = data;
                console.log(updates)
                document.getElementById('city').innerHTML = "";
                document.getElementById('date').innerHTML = "";
                document.getElementById('temp').innerHTML = "";
                document.getElementById('desc').innerHTML = "";
                if (updates.length > 0 & updates != {}) {
                    let text0 = updates[0]['city'];
                    let text1 = updates[1]['today'];
                    let text2 = updates[2]['temperature'];
                    let text3 = updates[3]['description'];
                    city = `<li class="list-group-item d-flex justify-content-between align-items-center">
                                ${text0}
                            </li>`
                    $('#city').append(city);
                    date = `<li class="list-group-item d-flex justify-content-between align-items-center">
                                ${text1}
                            </li>`
                    $('#date').append(date);
                    temp = `<li class="list-group-item d-flex justify-content-between align-items-center">
                                ${text2}
                            </li>`
                    $('#temp').append(temp);
                    desc = `<li class="list-group-item d-flex justify-content-between align-items-center">
                                ${text3}
                            </li>`
                    $('#desc').append(desc);

                } else {
                    mystr = `<li class="list-group-item d-flex justify-content-between align-items-center">Weather deatails not available</li>`
                    $('#item').append(mystr);
                }


            });
        event.preventDefault();

    });
</script>
<script>
    function myFunction() {
        var x = document.getElementById("cityname").value;
         document.getElementById("city_name").value = x;
    }
    
</script>

</html>